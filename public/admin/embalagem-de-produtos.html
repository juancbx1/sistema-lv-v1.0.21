<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embalagem de Produtos</title>
    <link rel="stylesheet" href="/css/menu-lateral.css">
    <link rel="stylesheet" href="/css/embalagem-de-produtos.css"> <!-- Novo CSS que vamos criar -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="hamburger-menu">
        <i class="fas fa-bars"></i>
        <i class="fas fa-times"></i>
    </div>

    <main class="ep-main-content">
        <header class="ep-page-header">
            <h1>Embalagem de Produtos</h1>
        </header>

        <!-- SEÇÃO DE ARREMATE PENDENTE -->
        <section id="arremateView" class="ep-section" aria-labelledby="arremate-heading">
            <h2 id="arremate-heading" class="ep-section-title">Arremate Pendente</h2>
            <p class="ep-section-description">Ordens de produção aguardando o processo de arremate para serem liberadas para embalagem.</p>
            
            <div class="ep-table-container">
                <table id="arremateTable" class="ep-data-table">
                    <thead>
                        <tr>
                            <th>OP</th>
                            <th>Produto</th>
                            <th>Variação</th>
                            <th>Qtd. Total OP</th>
                            <th>Qtd. Pendente</th>
                            <th>Usuário Arremate</th>
                            <th>Arrematar Qtd.</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody id="arremateTableBody">
                        <!-- Conteúdo gerado por JS -->
                    </tbody>
                </table>
            </div>
            <div id="arrematePaginationContainer" class="ep-pagination-container">
                <!-- Paginação gerada por JS -->
            </div>
        </section>

        <!-- SEÇÃO DE PRODUTOS PRONTOS PARA EMBALAR -->
        <section id="embalagemListView" class="ep-section" aria-labelledby="embalar-heading">
            <h2 id="embalar-heading" class="ep-section-title">Pronto para Embalar</h2>
            
            <div class="ep-filter-panel">
                <div class="ep-filter-group">
                    <div class="ep-filter-item">
                        <label for="searchProduto">Pesquisar Produto</label>
                        <input type="text" id="searchProduto" class="ep-input" placeholder="Buscar por produto, variação ou OP...">
                    </div>
                    <!-- Poderíamos adicionar mais filtros aqui no futuro, como categoria, etc. -->
                </div>
            </div>
            
            <div class="ep-table-container-wrapper"> <!-- Wrapper para a tabela e os cards mobile -->
                <div class="ep-table-container" id="produtosTableContainer">
                    <table id="produtosTable" class="ep-data-table">
                        <thead>
                            <tr>
                                <th>Produto</th>
                                <th>Variação</th>
                                <th class="col-img">Img</th>
                                <th class="col-qtd">Qtd. Disp.</th>
                                <th>OP Origem</th>
                            </tr>
                        </thead>
                        <tbody id="produtosTableBody">
                            <!-- Conteúdo gerado por JS -->
                        </tbody>
                    </table>
                </div>
                <div id="productCardContainer" class="ep-product-card-container">
                    <!-- Cards para visualização mobile gerados por JS -->
                </div>
            </div>
            <div id="paginationContainer" class="ep-pagination-container">
                <!-- Paginação gerada por JS -->
            </div>
        </section>

        <!-- SEÇÃO DE DETALHE DA EMBALAGEM (MODAL/VIEW) -->
        <section id="embalarView" class="ep-section ep-embalar-view hidden" aria-labelledby="embalar-detalhe-heading">
            <button class="ep-btn ep-btn-secondary ep-btn-voltar" id="voltarBtn"><i class="fas fa-arrow-left"></i> Voltar para Lista</button>
            
            <div class="ep-embalar-header">
                <div class="ep-thumbnail-detalhe" id="embalagemThumbnail">
                    <!-- Imagem do produto/variante -->
                </div>
                <div class="ep-embalar-title-group">
                    <h2 id="embalagemTitle" class="ep-section-title-inline">Embalar Produto</h2>
                    <p id="embalagemSubTitle" class="ep-sub-title"></p> <!-- Para Produto: Variante (OP: XXX) -->
                </div>
            </div>

            <div class="ep-tabs">
                <button class="ep-tab-btn active" data-tab="unidade">Embalar Unidade</button>
                <button class="ep-tab-btn" data-tab="kit">Montar e Embalar Kit</button>
            </div>

            <!-- PAINEL DA ABA UNIDADE -->
            <div class="ep-tab-panel active" id="unidade-tab">
                <div class="ep-embalar-form-card">
                    <div class="ep-info-group">
                        <p><strong>Produto:</strong> <span id="produtoNome">Nome do Produto</span></p>
                        <p><strong>Variação:</strong> <span id="varianteNome">Nome da Variante</span></p>
                        <p><strong>OP de Origem:</strong> <span id="opOrigemEmbalagem"></span></p>
                    </div>
                    <div class="ep-qtd-disponivel-destaque">
                        <span>Disponível para Embalagem:</span>
                        <strong id="qtdDisponivel">0</strong>
                    </div>
                    <div class="ep-form-group">
                        <label for="qtdEnviar">Quantidade de Unidades a Embalar:</label>
                        <input type="number" id="qtdEnviar" class="ep-input ep-input-grande" min="1" placeholder="0">
                    </div>
                    <button id="estoqueBtn" class="ep-btn ep-btn-success ep-btn-grande" disabled><i class="fas fa-box-open"></i> Embalar e Enviar para Estoque</button>
                </div>
            </div>

            <!-- PAINEL DA ABA KIT -->
            <div class="ep-tab-panel" id="kit-tab">
                <div class="ep-embalar-form-card">
                    <div id="kit-section">
                        <h3>Selecione o Kit para Montagem:</h3>
                        <div id="kits-list" class="ep-kits-list">
                            <!-- Botões de kit gerados por JS -->
                        </div>
                        
                        <div id="kit-variacao-composicao-wrapper" class="hidden">
                            <div class="ep-form-group">
                                <label for="kit-variacoes">Selecione a Variação do Kit:</label>
                                <select id="kit-variacoes" class="ep-select">
                                    <!-- Opções de variação do kit geradas por JS -->
                                </select>
                            </div>

                            <div id="kit-table-container" class="ep-kit-composicao-container hidden">
                                <h4>Componentes Necessários para 1 Kit:</h4>
                                <table id="kit-table" class="ep-mini-table">
                                    <thead>
                                        <tr>
                                            <th>Componente (Produto/Variação)</th>
                                            <th>Qtd. Necessária</th>
                                            <th>Qtd. Disponível</th>
                                        </tr>
                                    </thead>
                                    <tbody id="kit-table-body"></tbody>
                                </table>
                                <p id="kit-error-message" class="ep-error-message hidden"></p>
                            </div>
                        
                            <div id="kit-footer" class="ep-kit-footer">
                                <div class="ep-qtd-disponivel-destaque ep-qtd-kits-montaveis">
                                    <span>Kits Montáveis com Estoque Atual:</span>
                                    <strong id="qtd-disponivel-kits">0</strong>
                                </div>
                                <div class="ep-form-group">
                                    <label for="qtd-enviar-kits">Quantidade de Kits a Montar e Embalar:</label>
                                    <input type="number" id="qtd-enviar-kits" class="ep-input ep-input-grande" min="0" placeholder="0" disabled>
                                </div>
                                <button id="kit-estoque-btn" class="ep-btn ep-btn-success ep-btn-grande" disabled><i class="fas fa-boxes"></i> Montar e Embalar Kits</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script src="/js/admin-embalagem-de-produtos.js" type="module"></script>
    <script src="/js/carregar-menu-lateral.js" type="module"></script>
</body>
</html>